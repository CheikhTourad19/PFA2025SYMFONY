
{% extends 'admin/admin.base.html.twig' %}

{% block content %}
    <div x-data="{ activeTab: 'medecin', searchQuery: '' }" class="container mx-auto p-6">
        <!-- Role Tabs -->
        <div class="flex gap-4 mb-6 border-b">
            <button @click="activeTab = 'medecin'"
                    :class="{ 'border-b-2 border-blue-500': activeTab === 'medecin' }"
                    class="px-4 py-2 text-gray-600 hover:text-blue-600">
                Médecins ({{ medecins|length }})
            </button>
            <button @click="activeTab = 'pharmacie'"
                    :class="{ 'border-b-2 border-blue-500': activeTab === 'pharmacie' }"
                    class="px-4 py-2 text-gray-600 hover:text-blue-600">
                Pharmacies ({{ pharmacies|length }})
            </button>
            <button @click="activeTab = 'infermier'"
                    :class="{ 'border-b-2 border-blue-500': activeTab === 'infermier' }"
                    class="px-4 py-2 text-gray-600 hover:text-blue-600">
                Infirmiers ({{ infermiers|length }})
            </button>
        </div>

        <!-- Search and Add Button -->
        <div class="flex justify-between mb-6">
            <input type="text" x-model="searchQuery"
                   placeholder="Rechercher..."
                   class="w-64 px-4 py-2 border rounded-lg">
            <a href="#"
               class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"
               @click.prevent="window.location.href = '{{ path('app_admin_user_add', {type: 'medecin'}) }}'.replace('medecin', activeTab)">
                + Ajouter
            </a>
        </div>

        <!-- Medecins Table -->
        <template x-if="activeTab === 'medecin'">
            <table class="w-full bg-white rounded-lg shadow">
                <thead>
                <tr class="border-b">
                    <th class="px-6 py-3 text-left">Nom</th>
                    <th class="px-6 py-3 text-left">Prenom</th>
                    <th class="px-6 py-3 text-left">Email</th>
                    <th class="px-6 py-3 text-left">Num Tél</th>
                    <th class="px-6 py-3 text-left">Spécialité</th>
                    <th class="px-6 py-3 text-left">Actions</th>
                </tr>
                </thead>
                <tbody>
                {% for medecin in medecins %}
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4"> {{ medecin.user.nom }}</td>
                        <td class="px-6 py-4"> {{ medecin.user.prenom }}</td>
                        <td class="px-6 py-4">{{ medecin.user.email }}</td>
                        <td class="px-6 py-4"> {{ medecin.user.numero }}</td>
                        <td class="px-6 py-4">{{ medecin.service }}</td>
                        <td class="px-6 py-4 space-x-2">
                            <a href="{{ path('app_admin_user_edit', {type: 'medecin', id: medecin.user.id}) }}"
                               class="text-blue-600 hover:text-blue-900">Modifier</a>
                            <a href="{{ path('app_admin_user_delete', {type: 'medecin', id: medecin.user.id}) }}"
                               class="text-red-600 hover:text-red-900"
                               onclick="return confirm('Confirmer la suppression?')">Supprimer</a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </template>

        <!-- Similar templates for Pharmacies and Infermiers -->
        <!-- Infermier Table -->
        <template x-if="activeTab === 'infermier'">
            <table class="w-full bg-white rounded-lg shadow">
                <thead>
                <tr class="border-b">
                    <th class="px-6 py-3 text-left">Nom</th>
                    <th class="px-6 py-3 text-left">Prenom</th>
                    <th class="px-6 py-3 text-left">Email</th>
                    <th class="px-6 py-3 text-left">Num Tél</th>
                    <th class="px-6 py-3 text-left">Spécialité</th>
                    <th class="px-6 py-3 text-left">Actions</th>
                </tr>
                </thead>
                <tbody>
                {% for infermier in infermiers %}
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4"> {{ infermier.user.nom }}</td>
                        <td class="px-6 py-4"> {{ infermier.user.prenom }}</td>
                        <td class="px-6 py-4">{{ infermier.user.email }}</td>
                        <td class="px-6 py-4"> {{ infermier.user.numero }}</td>
                        <td class="px-6 py-4">{{ infermier.service }}</td>
                        <td class="px-6 py-4 space-x-2">
                            <a href="{{ path('app_admin_user_edit', {type: 'infermier', id: infermier.user.id}) }}"
                               class="text-blue-600 hover:text-blue-900">Modifier</a>
                            <a href="{{ path('app_admin_user_delete', {type: 'infermier', id: infermier.user.id}) }}"
                               class="text-red-600 hover:text-red-900"
                               onclick="return confirm('Confirmer la suppression?')">Supprimer</a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </template>

        <template x-if="activeTab === 'pharmacie'">
            <table class="w-full bg-white rounded-lg shadow">
                <thead>
                <tr class="border-b">
                    <th class="px-6 py-3 text-left">Nom</th>
                    <th class="px-6 py-3 text-left">Prenom</th>
                    <th class="px-6 py-3 text-left">Email</th>
                    <th class="px-6 py-3 text-left">Num Tél</th>
                    <th class="px-6 py-3 text-left">CIN</th>
                    <th class="px-6 py-3 text-left">Adresse</th>
                    <th class="px-6 py-3 text-left">Actions</th>
                </tr>

                </thead>
                <tbody>
                {% for pharmacie in pharmacies %}
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4"> {{ pharmacie.user.nom }}</td>
                        <td class="px-6 py-4"> {{ pharmacie.user.prenom }}</td>
                        <td class="px-6 py-4">{{ pharmacie.user.email }}</td>
                        <td class="px-6 py-4"> {{ pharmacie.user.numero }}</td>
                        <td class="px-6 py-4">{{ pharmacie.cin }}</td>
                        <td class="px-6 py-4">{{ pharmacie.adresse.rue ?? 'N/A' }} {{ pharmacie.adresse.ville ?? 'N/A' }} {{ pharmacie.adresse.quartier ?? 'N/A' }}</td>
                        <td class="px-6 py-4 space-x-2">
                            <a href="{{ path('app_admin_user_edit', {type: 'pharmacie', id: pharmacie.user.id}) }}"
                               class="text-blue-600 hover:text-blue-900">Modifier</a>
                            <a href="{{ path('app_admin_user_delete', {type: 'pharmacie', id: pharmacie.user.id}) }}"
                               class="text-red-600 hover:text-red-900"
                               onclick="return confirm('Confirmer la suppression?')">Supprimer</a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </template>
    </div>
{% endblock %}